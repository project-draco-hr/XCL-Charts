{
  float cirX=plotArea.getCenterX();
  float cirY=plotArea.getCenterY();
  float radius=getRadius();
  float arcLeft=cirX - radius;
  float arcTop=cirY - radius;
  float arcRight=cirX + radius;
  float arcBottom=cirY + radius;
  RectF arcRF0=new RectF(arcLeft,arcTop,arcRight,arcBottom);
  Paint paintArc=new Paint();
  paintArc.setAntiAlias(true);
  List<PieData> chartDataSource=this.getDataSource();
  int initOffsetAgent=mOffsetAgent;
  float currentAgent=0.0f;
  for (int i=0; i < mRender3DLevel; i++) {
    this.mCanvas.save(Canvas.MATRIX_SAVE_FLAG);
    mCanvas.translate(0,mRender3DLevel - i);
    for (int j=0; j < chartDataSource.size(); j++) {
      PieData cData=chartDataSource.get(j);
      paintArc.setColor(cData.getSliceColor());
      currentAgent=cData.getSliceAgent();
      if (cData.getSelected()) {
        float newRadius=radius / 10;
        mCalc.CalcArcEndPointXY(cirX,cirY,newRadius,mOffsetAgent + currentAgent / 2);
        float arcLeft2=mCalc.getPosX() - radius;
        float arcTop2=mCalc.getPosY() - radius;
        float arcRight2=mCalc.getPosX() + radius;
        float arcBottom2=mCalc.getPosY() + radius;
        RectF arcRF1=new RectF(arcLeft2,arcTop2,arcRight2,arcBottom2);
        mCanvas.drawArc(arcRF1,mOffsetAgent,currentAgent,true,paintArc);
      }
 else {
        mCanvas.drawArc(arcRF0,mOffsetAgent,currentAgent,true,paintArc);
      }
      mOffsetAgent+=currentAgent;
    }
    mCanvas.restore();
    mOffsetAgent=initOffsetAgent;
  }
  DrawHelper dw=new DrawHelper();
  currentAgent=0.0f;
  for (int j=0; j < chartDataSource.size(); j++) {
    PieData cData=chartDataSource.get(j);
    currentAgent=cData.getSliceAgent();
    int darkColor=dw.getDarkerColor((int)cData.getSliceColor());
    paintArc.setColor(darkColor);
    if (cData.getSelected()) {
      float newRadius=radius / 10;
      mCalc.CalcArcEndPointXY(cirX,cirY,newRadius,mOffsetAgent + currentAgent / 2);
      float arcLeft2=mCalc.getPosX() - radius;
      float arcTop2=mCalc.getPosY() - radius;
      float arcRight2=mCalc.getPosX() + radius;
      float arcBottom2=mCalc.getPosY() + radius;
      RectF arcRF1=new RectF(arcLeft2,arcTop2,arcRight2,arcBottom2);
      mCanvas.drawArc(arcRF1,mOffsetAgent,currentAgent,true,paintArc);
      drawLabel(cData.getLabel(),mCalc.getPosX(),mCalc.getPosY(),radius,mOffsetAgent,currentAgent);
    }
 else {
      mCanvas.drawArc(arcRF0,mOffsetAgent,currentAgent,true,paintArc);
      drawLabel(cData.getLabel(),cirX,cirY,radius,mOffsetAgent,currentAgent);
    }
    mOffsetAgent+=currentAgent;
  }
  renderKey();
}
